mod analysis;
mod func;
mod indices;
mod kind;
mod lang;
mod nat;
mod rules;
mod shifted;

use egg::{Id, Language, RecExpr, Rewrite};

use analysis::RiseAnalysis;
use indices::{Index, Shift};
use kind::{Kind, Kindable};
use lang::Rise;

pub use lang::PrettyPrint;

#[derive(Copy, Clone, Eq, PartialEq, Debug, Hash)]
pub enum RiseRuleset {
    MM,
}

#[must_use]
pub fn rules(ruleset: RiseRuleset) -> Vec<Rewrite<Rise, RiseAnalysis>> {
    match ruleset {
        RiseRuleset::MM => rules::mm_rules(),
    }
}

fn build(rec_expr: &RecExpr<Rise>, id: Id) -> RecExpr<Rise> {
    rec_expr[id]
        .clone()
        .build_recexpr(|child_id| rec_expr[child_id].clone())
}

// fn add(to: &mut Vec<Rise>, e: Rise) -> Id {
//     to.push(e);
//     Id::from(to.len() - 1)
// }

fn add_expr(to: &mut RecExpr<Rise>, e: RecExpr<Rise>) -> Id {
    let offset = to.len();
    for n in e {
        to.add(n.map_children(|id| Id::from(usize::from(id) + offset)));
    }
    to.root()
}

// fn add_expr_vec(to: &mut Vec<Rise>, e: &[Rise]) -> Id {
//     let offset = to.len();
//     to.extend(e.iter().map(|n| {
//         n.clone()
//             .map_children(|id| Id::from(usize::from(id) + offset))
//     }));
//     Id::from(to.len() - 1)
// }

// START TERM
const MM: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n1 f32)) (fun (arrT %n2 (arrT %n0 f32)) (arrT %n2 (arrT %n1 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) f32) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduce (fun (fun f32 (fun f32 f32)) (fun f32 (fun (arrT %n0 f32) f32)))) (typeOf add (fun f32 (fun f32 f32)))) (fun f32 (fun (arrT %n0 f32) f32))) (typeOf 0.0 f32)) (fun (arrT %n0 f32) f32)) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT f32 f32) f32) (fun (arrT %n0 (pairT f32 f32)) (arrT %n0 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) f32)) (fun (pairT f32 f32) f32))) (fun (arrT %n0 (pairT f32 f32)) (arrT %n0 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT %n0 f32))) f32)) (fun (arrT %n0 f32) f32))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 f32))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 f32))) (fun (arrT %n0 f32) (arrT %n1 f32)))) (fun (arrT %n2 (arrT %n0 f32)) (arrT %n2 (arrT %n1 f32)))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";

// GUIDES
const SPLIT_GUIDE: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n1 f32)) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n1 f32))))) (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 f32)) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) f32) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun f32 (fun (arrT 4 (pairT f32 f32)) f32)) (fun f32 (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))) f32)))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf %e1 f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun f32 (fun (pairT f32 f32) f32)) (fun f32 (fun (arrT 4 (pairT f32 f32)) f32)))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf %e1 f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) f32)) f32)) (fun (pairT f32 f32) f32))) (fun f32 (fun (pairT f32 f32) f32)))) (fun f32 (fun (arrT 4 (pairT f32 f32)) f32))) (typeOf 0.0 f32)) (fun (arrT 4 (pairT f32 f32)) f32)) (typeOf %e0 (arrT 4 (pairT f32 f32)))) f32)) f32)) (fun (arrT 4 (pairT f32 f32)) f32))) (fun f32 (fun (arrT 4 (pairT f32 f32)) f32)))) (fun f32 (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))) f32))) (typeOf 0.0 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))) f32)) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) f32)) (fun (arrT %n0 f32) f32))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT %n1 f32))) (fun (arrT %n0 f32) (arrT %n1 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const REORDER_1_GUIDE: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT f32 (pairT f32 f32)) f32) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 (pairT f32 f32)) f32)) (typeOf %e0 (pairT f32 (pairT f32 f32)))) f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) f32)) f32)) (fun (pairT f32 (pairT f32 f32)) f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32))))))) (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32)))))) (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT 32 (arrT %n0 (pairT f32 f32))))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const REORDER_2_GUIDE: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT f32 (pairT f32 f32)) f32) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 (pairT f32 f32)) f32)) (typeOf %e0 (pairT f32 (pairT f32 f32)))) f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) f32)) f32)) (fun (pairT f32 (pairT f32 f32)) f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const STORE_GUIDE: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT f32 (pairT f32 f32)) f32) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 (pairT f32 f32)) f32)) (typeOf %e0 (pairT f32 (pairT f32 f32)))) f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) f32)) f32)) (fun (pairT f32 (pairT f32 f32)) f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (app (typeOf let (fun (arrT %n1 (arrT %n0 f32)) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32))))) (typeOf (app (typeOf toMem (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 (arrT 32 f32)) (arrT 32 (arrT %n0 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32)))))) (typeOf transpose (fun (arrT %n0 (arrT 32 f32)) (arrT 32 (arrT %n0 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT 32 f32) (arrT 32 f32)) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))))) (typeOf (app (typeOf map (fun (fun f32 f32) (fun (arrT 32 f32) (arrT 32 f32)))) (typeOf (lam (typeOf %e0 f32)) (fun f32 f32))) (fun (arrT 32 f32) (arrT 32 f32)))) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT %n0 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32)))))) (typeOf transpose (fun (arrT 32 (arrT %n0 f32)) (arrT %n0 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT %n0 (arrT 32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 (arrT %n0 f32)))) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (lam (typeOf %e0 (arrT %n1 (arrT %n0 f32)))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";

// GOALS
const BASELINE_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n1 f32)) (fun (arrT %n2 (arrT %n0 f32)) (arrT %n2 (arrT %n1 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) f32) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun f32 (fun (pairT f32 f32) f32)) (fun f32 (fun (arrT %n0 (pairT f32 f32)) f32)))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf %e1 f32)) (fun f32 f32)) (typeOf (app (typeOf (lam (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) f32)) (fun (pairT f32 f32) f32)) (typeOf %e0 (pairT f32 f32))) f32)) f32)) (fun (pairT f32 f32) f32))) (fun f32 (fun (pairT f32 f32) f32)))) (fun f32 (fun (arrT %n0 (pairT f32 f32)) f32))) (typeOf 0.0 f32)) (fun (arrT %n0 (pairT f32 f32)) f32)) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) f32)) (fun (arrT %n0 f32) f32))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 f32))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 f32))) (fun (arrT %n0 f32) (arrT %n1 f32)))) (fun (arrT %n2 (arrT %n0 f32)) (arrT %n2 (arrT %n1 f32)))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const BLOCKING_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT f32 (pairT f32 f32)) f32) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 (pairT f32 f32)) f32)) (typeOf %e0 (pairT f32 (pairT f32 f32)))) f32)) (fun f32 f32)) (typeOf (app (typeOf (app (typeOf mul (fun f32 (fun f32 f32))) (typeOf (app (typeOf fst (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) (fun f32 f32)) (typeOf (app (typeOf snd (fun (pairT f32 f32) f32)) (typeOf (app (typeOf snd (fun (pairT f32 (pairT f32 f32)) (pairT f32 f32))) (typeOf %e0 (pairT f32 (pairT f32 f32)))) (pairT f32 f32))) f32)) f32)) f32)) (fun (pairT f32 (pairT f32 f32)) f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32))))))) (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32)))))) (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT 32 (arrT %n0 (pairT f32 f32))))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const VECTORIZATION_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf (app (typeOf mul (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (vecT 32 f32))) (vecT 32 f32))) (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (typeOf %e0 (arrT 32 (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (pairT f32 f32))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32))))))) (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32)))))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (pairT (arrT 32 (arrT 32 f32)) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (arrT 32 (pairT f32 f32)))))) (arrT 4 (arrT 32 (arrT 32 (pairT f32 f32)))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 (pairT f32 f32))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32)))))) (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT 32 (arrT %n0 (pairT f32 f32))))) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const LOOP_PERM_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))))) (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))))) (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf (app (typeOf mul (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (vecT 32 f32))) (vecT 32 f32))) (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const ARRAY_PACKING_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32)))) (typeOf (app (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf (app (typeOf mul (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (vecT 32 f32))) (vecT 32 f32))) (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (arrT 32 (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (app (typeOf let (fun (arrT %n1 (arrT %n0 f32)) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32))))) (typeOf (app (typeOf toMem (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf mapPar (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32)))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT 32 f32)) (arrT 32 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 f32) (arrT 32 f32)) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (vecT 32 f32) (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf %e0 (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf %e0 (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 f32) (arrT 32 f32)))) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT %n0 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT 32 (arrT %n0 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 (arrT %n0 f32)))) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (lam (typeOf %e0 (arrT %n1 (arrT %n0 f32)))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const CACHE_BLOCKS_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32)))) (typeOf (app (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeqUnroll (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf (app (typeOf mul (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (vecT 32 f32))) (vecT 32 f32))) (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (arrT 32 (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (app (typeOf let (fun (arrT %n1 (arrT %n0 f32)) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32))))) (typeOf (app (typeOf toMem (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf mapPar (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32)))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT 32 f32)) (arrT 32 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 f32) (arrT 32 f32)) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (vecT 32 f32) (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf %e0 (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf %e0 (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 f32) (arrT 32 f32)))) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT %n0 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT 32 (arrT %n0 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 (arrT %n0 f32)))) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (lam (typeOf %e0 (arrT %n1 (arrT %n0 f32)))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";
const PARALLEL_GOAL: &str = "(typeOf (natLam (typeOf (natLam (typeOf (natLam (typeOf (lam (typeOf (lam (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))) (arrT %n2 (arrT %n1 f32)))) (typeOf (app (typeOf (app (typeOf mapPar (fun (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32))))) (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32)) (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))) (arrT 32 (arrT %n1 f32)))) (typeOf (app (typeOf transpose (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (fun (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeqUnroll (fun (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf add (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf (app (typeOf mul (fun (vecT 32 f32) (fun (vecT 32 f32) (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (vecT 32 f32)) (vecT 32 f32))) (typeOf (app (typeOf snd (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (pairT (vecT 32 f32) (vecT 32 f32)))) (typeOf %e0 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))) (pairT (vecT 32 f32) (vecT 32 f32)))) (vecT 32 f32))) (vecT 32 f32))) (vecT 32 f32))) (fun (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))) (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32))))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 1 (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32)))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 f32)) (pairT (arrT 32 f32) (arrT 32 f32)))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))) (arrT 32 (pairT f32 f32)))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (pairT f32 f32))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 (pairT f32 f32))))) (pairT (arrT 32 f32) (arrT 32 (pairT f32 f32))))) (arrT 32 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 f32)))) (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (pairT (vecT 32 f32) (vecT 32 f32))))) (arrT 1 (pairT (vecT 32 f32) (pairT (vecT 32 f32) (vecT 32 f32)))))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32)))))) (typeOf %e1 (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 (pairT f32 (pairT f32 f32))))) (typeOf %e0 (arrT 32 (pairT f32 f32)))) (arrT 32 (pairT f32 (pairT f32 f32))))) (arrT 32 f32))) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32)))) (fun (arrT 32 f32) (fun (arrT 32 (pairT f32 f32)) (arrT 32 f32))))) (fun (arrT 32 f32) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32)))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 4 (arrT 32 (pairT f32 f32))) (arrT 32 f32))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 4 (arrT 32 (pairT f32 f32))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf unzip (fun (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 f32) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf fst (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 f32))) (fun (arrT 32 (arrT 4 (pairT f32 f32))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (typeOf (app (typeOf snd (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 4 (pairT f32 f32))))) (typeOf %e0 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (pairT f32 (arrT 4 (pairT f32 f32)))))) (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 4 (arrT 32 (pairT f32 f32))))) (arrT 32 f32))) (fun (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 f32)))) (fun (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e1 (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (pairT (arrT 32 f32) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32)))) (arrT 32 (arrT 32 f32)))))) (fun (arrT 32 (arrT 32 f32)) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf generate (fun (fun (idxT 32) (arrT 32 f32)) (arrT 32 (arrT 32 f32)))) (typeOf (lam (typeOf (app (typeOf generate (fun (fun (idxT 32) f32) (arrT 32 f32))) (typeOf (lam (typeOf 0.0 f32)) (fun (idxT 32) f32))) (arrT 32 f32))) (fun (idxT 32) (arrT 32 f32)))) (arrT 32 (arrT 32 f32)))) (fun (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT 32 (arrT 32 f32)))) (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (arrT 32 (arrT 32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf %e0 (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT 32 f32))))) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT 32 f32))))) (arrT 32 (arrT %n1 f32)))) (fun (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (arrT 32 (arrT %n1 f32))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (typeOf transpose (fun (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))))) (typeOf (app (typeOf map (fun (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (lam (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n1 (natMul (natPow 4 -1) %n0)) (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n1) (arrT %n0 (pairT f32 f32)))))) 4) (fun (arrT %n0 (pairT f32 f32)) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (typeOf (app (typeOf (app (typeOf zip (fun (arrT %n0 f32) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32))))) (typeOf %e1 (arrT %n0 f32))) (fun (arrT %n0 f32) (arrT %n0 (pairT f32 f32)))) (typeOf %e0 (arrT %n0 f32))) (arrT %n0 (pairT f32 f32)))) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32)))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (app (typeOf let (fun (arrT %n1 (arrT %n0 f32)) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32))))) (typeOf (app (typeOf toMem (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf join (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf mapPar (fun (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32)))))) (typeOf (lam (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT 32 f32)) (arrT 32 (arrT %n0 f32)))) (typeOf (app (typeOf (app (typeOf map (fun (fun (arrT 32 f32) (arrT 32 f32)) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32))))) (typeOf (lam (typeOf (app (typeOf asScalar (fun (arrT 1 (vecT 32 f32)) (arrT 32 f32))) (typeOf (app (typeOf (app (typeOf map (fun (fun (vecT 32 f32) (vecT 32 f32)) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32))))) (typeOf (lam (typeOf %e0 (vecT 32 f32))) (fun (vecT 32 f32) (vecT 32 f32)))) (fun (arrT 1 (vecT 32 f32)) (arrT 1 (vecT 32 f32)))) (typeOf (app (typeOf (natApp (typeOf asVector (natFun (fun (arrT %n0 f32) (arrT 1 (vecT %n0 f32))))) 32) (fun (arrT 32 f32) (arrT 1 (vecT 32 f32)))) (typeOf %e0 (arrT 32 f32))) (arrT 1 (vecT 32 f32)))) (arrT 1 (vecT 32 f32)))) (arrT 32 f32))) (fun (arrT 32 f32) (arrT 32 f32)))) (fun (arrT %n0 (arrT 32 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf (app (typeOf transpose (fun (arrT 32 (arrT %n0 f32)) (arrT %n0 (arrT 32 f32)))) (typeOf %e0 (arrT 32 (arrT %n0 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT %n0 (arrT 32 f32)))) (arrT 32 (arrT %n0 f32)))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT %n0 f32))))) (fun (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n2 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n1 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (typeOf (app (typeOf transpose (fun (arrT %n0 (arrT %n1 f32)) (arrT %n1 (arrT %n0 f32)))) (typeOf %e1 (arrT %n0 (arrT %n1 f32)))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT %n1 (arrT %n0 f32)))) (fun (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))) (arrT %n1 (arrT %n0 f32)))) (typeOf (lam (typeOf %e0 (arrT %n1 (arrT %n0 f32)))) (fun (arrT %n1 (arrT %n0 f32)) (arrT %n1 (arrT %n0 f32))))) (arrT %n1 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n1) (arrT 32 (arrT (natMul (natPow 4 -1) %n0) (arrT 4 (pairT f32 f32))))))) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))) (fun (arrT %n0 f32) (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32)))))))) (fun (arrT 32 (arrT %n0 f32)) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (fun (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (typeOf (app (typeOf (natApp (typeOf split (natFun (fun (arrT (natMul %n3 (natMul (natPow 32 -1) %n0)) (arrT %n1 f32)) (arrT (natMul (natPow 32 -1) %n3) (arrT %n0 (arrT %n1 f32)))))) 32) (fun (arrT %n2 (arrT %n0 f32)) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (typeOf %e1 (arrT %n2 (arrT %n0 f32)))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n0 f32))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT (natMul (natPow 32 -1) %n1) (arrT (natMul (natPow 4 -1) %n0) (arrT 32 (arrT 4 (pairT f32 f32))))))))) (arrT (natMul (natPow 32 -1) %n2) (arrT 32 (arrT %n1 f32))))) (arrT %n2 (arrT %n1 f32)))) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))) (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))) (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))) (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32)))))))) (natFun (natFun (natFun (fun (arrT %n2 (arrT %n0 f32)) (fun (arrT %n0 (arrT %n1 f32)) (arrT %n2 (arrT %n1 f32))))))))";

#[cfg(test)]
mod test {

    use egg::{AstSize, RecExpr, Runner, SimpleScheduler};

    use crate::sketch::eclass_extract;

    use super::*;

    #[test]
    fn mm_first() {
        let mm: RecExpr<Rise> = MM.parse().unwrap();
        println!("mm nodes: {}", mm.len());
    }

    #[test]
    fn mm_full_test() {
        // START TERM
        let mm: RecExpr<Rise> = MM.parse().unwrap();
        println!("mm nodes: {}", mm.len());

        // GUIDES
        let split_guide: RecExpr<Rise> = SPLIT_GUIDE.parse().unwrap();
        println!("split_guide nodes: {}", split_guide.len());
        let reorder_1_guide: RecExpr<Rise> = REORDER_1_GUIDE.parse().unwrap();
        println!("reorder_1_guide nodes: {}", reorder_1_guide.len());
        let reorder_2_guide: RecExpr<Rise> = REORDER_2_GUIDE.parse().unwrap();
        println!("reorder_2_guide nodes: {}", reorder_2_guide.len());
        let store_guide: RecExpr<Rise> = STORE_GUIDE.parse().unwrap();
        println!("store_guide nodes: {}", store_guide.len());

        // GOALS
        let baseline_goal: RecExpr<Rise> = BASELINE_GOAL.parse().unwrap();
        println!("baseline_goal nodes: {}", baseline_goal.len());
        let blocking_goal: RecExpr<Rise> = BLOCKING_GOAL.parse().unwrap();
        println!("blocking_goal: {}", blocking_goal.len());
        let vectorization_goal: RecExpr<Rise> = VECTORIZATION_GOAL.parse().unwrap();
        println!("vectorization_goal: {}", vectorization_goal.len());
        let loop_perm_goal: RecExpr<Rise> = LOOP_PERM_GOAL.parse().unwrap();
        println!("loop_perm_goal nodes: {}", loop_perm_goal.len());
        let array_packing_goal: RecExpr<Rise> = ARRAY_PACKING_GOAL.parse().unwrap();
        println!("array_packing_goal: {}", array_packing_goal.len());
        let cache_blocks_goal: RecExpr<Rise> = CACHE_BLOCKS_GOAL.parse().unwrap();
        println!("cache_blocks_goal {}", cache_blocks_goal.len());
        let parallel_goal: RecExpr<Rise> = PARALLEL_GOAL.parse().unwrap();
        println!("parallel_goal: {}", parallel_goal.len());
    }

    #[test]
    pub fn baseline_goal() {
        let mm: RecExpr<Rise> = MM.parse().unwrap();
        let baseline_goal: RecExpr<Rise> = BASELINE_GOAL.parse().unwrap();
        let bg2 = baseline_goal.clone();

        let runner = Runner::default();
        let r = runner
            .with_expr(&mm)
            .with_iter_limit(3)
            .with_scheduler(SimpleScheduler)
            .with_hook(move |r| {
                printer_hook(r);
                if r.egraph.lookup_expr(&bg2).is_some() {
                    return Err("FOUND IT".to_owned());
                }
                Ok(())
            })
            .run(&rules(RiseRuleset::MM));

        println!("{:?}\n\n\n", r.report());
        // println!("{}", r.egraph.dot());
        let root_mm = r.egraph.find(r.roots[0]);
        assert_eq!(root_mm, r.egraph.lookup_expr(&mm).unwrap());

        let baseline_sketch = sketchify(BASELINE_GOAL);
        let (_, sketch_extracted_baseline) =
            eclass_extract(&baseline_sketch, AstSize, &r.egraph, root_mm).unwrap();
        // println!("SKETCHIFIED AND EXTRACTED BASELINE:");
        // sketch_extracted_baseline.pp(false);
        // println!("BASELINE:");
        // baseline_goal.pp(false);

        let diff = find_diff(
            &sketch_extracted_baseline,
            sketch_extracted_baseline.root(),
            &baseline_goal,
            baseline_goal.root(),
        );
        println!("mm:");
        mm.pp(false);
        println!("baseline_goal:");
        baseline_goal.pp(false);
        println!("sketch_baseline_extr:");
        sketch_extracted_baseline.pp(false);
        assert_eq!(diff, None);
        // assert_eq!(root_mm, r.egraph.lookup_expr(&baseline_goal).unwrap());
    }

    fn printer_hook(r: &mut Runner<Rise, RiseAnalysis>) {
        println!("ITERATION {}:\n", r.iterations.len());
        println!("Nodes: {}\n", r.egraph.nodes().len());
        println!("EClasses: {}\n", r.egraph.number_of_classes());
        println!("Rules:");
        if let Some(i) = r.iterations.last() {
            for rule in &rules(RiseRuleset::MM) {
                let name = &rule.name;
                let n = i.applied.get(name).unwrap_or(&0);
                println!("{name}: {n}");
            }
        }
        println!("---");
    }

    fn sketchify(term: &str) -> crate::sketch::Sketch<Rise> {
        term.split_inclusive(['(', ')', ' '])
            .flat_map(|s| {
                s.char_indices().last().map_or(["", s], |(i, _)| {
                    let (a, b) = s.split_at(i);
                    [a, b]
                })
            })
            .map(|s| if s.contains('%') { " ? " } else { s })
            .collect::<String>()
            .parse()
            .unwrap()
    }

    fn find_diff(
        lhs: &RecExpr<Rise>,
        lhs_id: Id,
        rhs: &RecExpr<Rise>,
        rhs_id: Id,
    ) -> Option<(Rise, Rise)> {
        if let Rise::Var(index) = lhs[lhs_id]
            && let Rise::Var(index2) = rhs[rhs_id]
            && index != index2
        {
            Some((lhs[lhs_id].clone(), rhs[rhs_id].clone()))
        } else if lhs[lhs_id].matches(&rhs[rhs_id]) {
            lhs[lhs_id]
                .children()
                .iter()
                .zip(rhs[rhs_id].children())
                .find_map(|(lcid, rcid)| find_diff(lhs, *lcid, rhs, *rcid))
        } else {
            Some((lhs[lhs_id].clone(), rhs[rhs_id].clone()))
        }
    }
}
