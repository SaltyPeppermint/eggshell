use egg::rewrite as rw;

use super::RiseRewrite;
use super::func::{
    compute_nat_check, not_free_in, pat, shifted, shifted_check, vectorize_scalar_fun,
};

pub fn mm_rules() -> Vec<RiseRewrite> {
    vec![
        rw!("map-fission"; "(typeOf (app (typeOf map ?) (typeOf (lam (typeOf (app (typeOf ?e0 ?) (typeOf ?e1 ?dt0)) ?)) (app (app fun ?dt1) ?dt2))) (app (app fun (app (app arrT ?n0) ?dt1)) (app (app arrT ?n0) ?dt2)))" => { not_free_in("?0", 0, shifted("?1", "?2", 1, 1, shifted("?n0", "?n1", 1, 0, shifted("?dt1", "?dt4", 1, 0, shifted("?dt2", "?dt3", 1, 0, shifted("?dt0", "?dt5", 1, 1, pat("(typeOf (lam (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt3)) (app (app fun (app (app arrT ?n1) ?dt0)) (app (app arrT ?n1) ?dt3)))) (typeOf ?e0 (app (app fun ?dt0) ?dt3))) (app (app fun (app (app arrT ?n1) ?dt0)) (app (app arrT ?n1) ?dt3))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt4) ?dt0)) (app (app fun (app (app arrT ?n1) ?dt4)) (app (app arrT ?n1) ?dt0)))) (typeOf (lam (typeOf ?e2 ?dt5)) (app (app fun ?dt4) ?dt0))) (app (app fun (app (app arrT ?n1) ?dt4)) (app (app arrT ?n1) ?dt0))) (typeOf %0 (app (app arrT ?n1) ?dt4))) (app (app arrT ?n1) ?dt0))) (app (app arrT ?n1) ?dt3))) (app (app fun (app (app arrT ?n0) ?dt1)) (app (app arrT ?n0) ?dt2)))"))))))) }),
        rw!("reduce-seq"; "(typeOf reduce (app (app fun (app (app fun ?dt0) (app (app fun ?dt0) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt0)) ?dt0))))" => "(typeOf reduceSeq (app (app fun (app (app fun ?dt0) (app (app fun ?dt0) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt0)) ?dt0))))"),
        rw!("eliminate-map-identity"; "(typeOf (app (typeOf map ?) (typeOf (lam (typeOf %0 ?)) (app (app fun ?dt0) ?dt0))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt0)))" => { shifted("?n0", "?n1", 1, 0, shifted("?dt0", "?dt1", 1, 0, pat("(typeOf (lam (typeOf %0 (app (app arrT ?n1) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt0)))"))) }),
        rw!("reduce-seq-map-fusion"; "(typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq ?) (typeOf ?e0 (app (app fun ?dt0) (app (app fun ?dt1) ?dt0)))) ?) (typeOf ?e1 ?dt0)) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e2 (app (app fun ?dt2) ?dt1))) ?) (typeOf ?e3 (app (app arrT ?n0) ?dt2))) (app (app arrT ?n0) ?dt1))) ?dt0)" => { shifted("?2", "?5", 2, 0, shifted("?0", "?4", 2, 0, shifted("?dt2", "?dt5", 2, 0, shifted("?dt2", "?dt6", 1, 0, shifted("?dt1", "?dt4", 2, 0, shifted("?dt0", "?dt3", 2, 0, shifted("?dt0", "?dt7", 1, 0, pat("(typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun ?dt0) (app (app fun ?dt2) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt2)) ?dt0)))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e4 (app (app fun ?dt3) (app (app fun ?dt4) ?dt3))) (typeOf %1 ?dt3)) (app (app fun ?dt4) ?dt3)) (typeOf (app (typeOf ?e5 (app (app fun ?dt5) ?dt4)) (typeOf %0 ?dt5)) ?dt4)) ?dt3)) (app (app fun ?dt6) ?dt7))) (app (app fun ?dt0) (app (app fun ?dt2) ?dt0)))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt2)) ?dt0))) (typeOf ?e1 ?dt0)) (app (app fun (app (app arrT ?n0) ?dt2)) ?dt0)) (typeOf ?e3 (app (app arrT ?n0) ?dt2))) ?dt0)")))))))) }),
        rw!("split-join-32"; "(typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) ?) (typeOf ?e1 (app (app arrT ?n0) ?dt0))) (app (app arrT ?n0) ?dt1))" => { shifted("?n0", "?n1", 1, 0, shifted("?dt0", "?dt2", 1, 0, pat("(typeOf (app (typeOf join (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))) (app (app arrT ?n0) ?dt1))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1))) (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1)))) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1)))) (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (typeOf (app (typeOf (app (typeOf split (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 32) -1)) ?n1))) ?dt2)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n1)) (app (app arrT %0) ?dt2))))) 32) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (typeOf ?e1 (app (app arrT ?n0) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (app (app arrT ?n0) ?dt1))"))) }),
        rw!("split-join-2m-32"; "(typeOf (app (typeOf (app (typeOf map ?) (typeOf (app (typeOf map ?) (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) ?) (typeOf ?e1 (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))" => { shifted("?n0", "?n3", 1, 0, shifted("?dt0", "?dt2", 1, 0, pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))))) (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))) (app (app arrT ?n0) ?dt1))) (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (typeOf join (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))))) (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))) (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))))) (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1))) (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1)))) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT 32) ?dt0)) (app (app arrT 32) ?dt1)))) (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1))))) (app (app fun (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))))))) (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))))) (typeOf (app (typeOf split (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 32) -1)) ?n3))) ?dt2)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n3)) (app (app arrT %0) ?dt2))))) 32) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0))))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))))) (typeOf ?e1 (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt0)))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app arrT 32) ?dt1)))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))"))) }),
        rw!("blocked-reduce-4"; "(typeOf (app (typeOf (app (typeOf (app (typeOf reduce ?) (typeOf ?e0 (app (app fun ?dt0) (app (app fun ?dt0) ?dt0)))) ?) (typeOf ?e1 ?dt0)) ?) (typeOf ?e2 (app (app arrT ?n0) ?dt0))) ?dt0)" => { shifted("?1", "?4", 2, 0, shifted("?0", "?3", 2, 0, shifted("?n0", "?n1", 1, 0, shifted("?dt0", "?dt1", 2, 0, shifted("?dt0", "?dt2", 1, 0, pat("(typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun ?dt0) (app (app fun (app (app arrT 4) ?dt0)) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT (app (app mul (app (app pow 4) -1)) ?n0)) (app (app arrT 4) ?dt0))) ?dt0)))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e3 (app (app fun ?dt1) (app (app fun ?dt1) ?dt1))) (typeOf %1 ?dt1)) (app (app fun ?dt1) ?dt1)) (typeOf (app (typeOf (app (typeOf (app (typeOf reduce (app (app fun (app (app fun ?dt1) (app (app fun ?dt1) ?dt1))) (app (app fun ?dt1) (app (app fun (app (app arrT 4) ?dt1)) ?dt1)))) (typeOf ?e3 (app (app fun ?dt1) (app (app fun ?dt1) ?dt1)))) (app (app fun ?dt1) (app (app fun (app (app arrT 4) ?dt1)) ?dt1))) (typeOf ?e4 ?dt1)) (app (app fun (app (app arrT 4) ?dt1)) ?dt1)) (typeOf %0 (app (app arrT 4) ?dt1))) ?dt1)) ?dt1)) (app (app fun (app (app arrT 4) ?dt2)) ?dt2))) (app (app fun ?dt0) (app (app fun (app (app arrT 4) ?dt0)) ?dt0)))) (app (app fun ?dt0) (app (app fun (app (app arrT (app (app mul (app (app pow 4) -1)) ?n0)) (app (app arrT 4) ?dt0))) ?dt0))) (typeOf ?e1 ?dt0)) (app (app fun (app (app arrT (app (app mul (app (app pow 4) -1)) ?n0)) (app (app arrT 4) ?dt0))) ?dt0)) (typeOf (app (typeOf (app (typeOf split (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 4) -1)) ?n1))) ?dt2)) (app (app arrT (app (app mul (app (app pow 4) -1)) ?n1)) (app (app arrT %0) ?dt2))))) 4) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT (app (app mul (app (app pow 4) -1)) ?n0)) (app (app arrT 4) ?dt0)))) (typeOf ?e2 (app (app arrT ?n0) ?dt0))) (app (app arrT (app (app mul (app (app pow 4) -1)) ?n0)) (app (app arrT 4) ?dt0)))) ?dt0)")))))) }),
        rw!("split-before-map"; "(typeOf (app (typeOf (app (typeOf split ?) ?n0) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) ?) (typeOf ?e1 (app (app arrT ?n1) ?dt0))) (app (app arrT ?n2) ?dt1))) (app (app arrT ?n3) (app (app arrT ?n0) ?dt1)))" => { shifted("?n3", "?n4", 1, 0, shifted("?dt0", "?dt2", 1, 0, compute_nat_check("?n1", "(app (app mul ?n3) ?n0)", compute_nat_check("?n2", "(app (app mul ?n3) ?n0)", pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1))) (app (app fun (app (app arrT ?n3) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n3) (app (app arrT ?n0) ?dt1))))) (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n3) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n3) (app (app arrT ?n0) ?dt1)))) (typeOf (app (typeOf (app (typeOf split (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) ?dt2)) (app (app arrT ?n4) (app (app arrT %0) ?dt2))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) ?dt0)) (app (app arrT ?n3) (app (app arrT ?n0) ?dt0)))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) ?dt0))) (app (app arrT ?n3) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n3) (app (app arrT ?n0) ?dt1)))"))))) }),
        rw!("reduce-seq-map-fission"; "(typeOf (app (typeOf (app (typeOf reduceSeq ?) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e0 ?) (typeOf %1 ?dt0)) ?) (typeOf ?e1 ?dt1)) ?)) ?)) (app (app fun ?dt2) (app (app fun ?dt3) ?dt2)))) ?) (typeOf ?e2 ?dt2)) (app (app fun (app (app arrT ?n0) ?dt3)) ?dt2))" => { not_free_in("?0", 0, shifted("?2", "?4", 1, 0, shifted("?0", "?3", -1, 2, shifted("?n0", "?n1", 1, 0, shifted("?dt3", "?dt6", 1, 0, shifted_check("?dt2", "?dt0", 2, 0, shifted("?dt2", "?dt4", 1, 0, shifted("?dt1", "?dt5", -1, 2, pat("(typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun ?dt4) (app (app fun ?dt5) ?dt4))) (app (app fun ?dt4) (app (app fun (app (app arrT ?n1) ?dt5)) ?dt4)))) (typeOf ?e3 (app (app fun ?dt4) (app (app fun ?dt5) ?dt4)))) (app (app fun ?dt4) (app (app fun (app (app arrT ?n1) ?dt5)) ?dt4))) (typeOf ?e4 ?dt4)) (app (app fun (app (app arrT ?n1) ?dt5)) ?dt4)) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt6) ?dt5)) (app (app fun (app (app arrT ?n1) ?dt6)) (app (app arrT ?n1) ?dt5)))) (typeOf (lam (typeOf ?e1 ?dt1)) (app (app fun ?dt6) ?dt5))) (app (app fun (app (app arrT ?n1) ?dt6)) (app (app arrT ?n1) ?dt5))) (typeOf %0 (app (app arrT ?n1) ?dt6))) (app (app arrT ?n1) ?dt5))) ?dt4)) (app (app fun (app (app arrT ?n0) ?dt3)) ?dt2))"))))))))) }),
        rw!("lift-reduce-seq"; "(typeOf (app (typeOf map ?) (typeOf (app (typeOf (app (typeOf reduceSeq ?) (typeOf ?e0 (app (app fun ?dt0) (app (app fun ?dt1) ?dt0)))) ?) (typeOf ?e1 ?dt0)) (app (app fun (app (app arrT ?n0) ?dt1)) ?dt0))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))) (app (app arrT ?n1) ?dt0)))" => { shifted("?1", "?3", 2, 0, shifted("?0", "?2", 4, 0, shifted("?n0", "?n3", 1, 0, shifted("?n1", "?n4", 3, 0, shifted("?n1", "?n5", 2, 0, shifted("?n1", "?n2", 1, 0, shifted("?dt1", "?dt7", 4, 0, shifted("?dt1", "?dt5", 3, 0, shifted("?dt1", "?dt8", 2, 0, shifted("?dt1", "?dt3", 1, 0, shifted("?dt0", "?dt6", 4, 0, shifted("?dt0", "?dt4", 3, 0, shifted("?dt0", "?dt9", 2, 0, shifted("?dt0", "?dt2", 1, 0, pat("(typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun (app (app arrT ?n2) ?dt2)) (app (app fun (app (app arrT ?n2) ?dt3)) (app (app arrT ?n2) ?dt2)))) (app (app fun (app (app arrT ?n2) ?dt2)) (app (app fun (app (app arrT ?n3) (app (app arrT ?n2) ?dt3))) (app (app arrT ?n2) ?dt2))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app pairT ?dt4) ?dt5)) ?dt4)) (app (app fun (app (app arrT ?n4) (app (app pairT ?dt4) ?dt5))) (app (app arrT ?n4) ?dt4)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e2 (app (app fun ?dt6) (app (app fun ?dt7) ?dt6))) (typeOf (app (typeOf fst (app (app fun (app (app pairT ?dt6) ?dt7)) ?dt6)) (typeOf %0 (app (app pairT ?dt6) ?dt7))) ?dt6)) (app (app fun ?dt7) ?dt6)) (typeOf (app (typeOf snd (app (app fun (app (app pairT ?dt6) ?dt7)) ?dt7)) (typeOf %0 (app (app pairT ?dt6) ?dt7))) ?dt7)) ?dt6)) (app (app fun (app (app pairT ?dt4) ?dt5)) ?dt4))) (app (app fun (app (app arrT ?n4) (app (app pairT ?dt4) ?dt5))) (app (app arrT ?n4) ?dt4))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n4) ?dt4)) (app (app fun (app (app arrT ?n4) ?dt5)) (app (app arrT ?n4) (app (app pairT ?dt4) ?dt5))))) (typeOf %1 (app (app arrT ?n4) ?dt4))) (app (app fun (app (app arrT ?n4) ?dt5)) (app (app arrT ?n4) (app (app pairT ?dt4) ?dt5)))) (typeOf %0 (app (app arrT ?n4) ?dt5))) (app (app arrT ?n4) (app (app pairT ?dt4) ?dt5)))) (app (app arrT ?n4) ?dt4))) (app (app fun (app (app arrT ?n5) ?dt8)) (app (app arrT ?n5) ?dt9)))) (app (app fun (app (app arrT ?n2) ?dt2)) (app (app fun (app (app arrT ?n2) ?dt3)) (app (app arrT ?n2) ?dt2))))) (app (app fun (app (app arrT ?n2) ?dt2)) (app (app fun (app (app arrT ?n3) (app (app arrT ?n2) ?dt3))) (app (app arrT ?n2) ?dt2)))) (typeOf (app (typeOf generate (app (app fun (app (app fun (app idxT ?n2)) ?dt2)) (app (app arrT ?n2) ?dt2))) (typeOf (lam (typeOf ?e3 ?dt9)) (app (app fun (app idxT ?n2)) ?dt2))) (app (app arrT ?n2) ?dt2))) (app (app fun (app (app arrT ?n3) (app (app arrT ?n2) ?dt3))) (app (app arrT ?n2) ?dt2))) (typeOf (app (typeOf transpose (app (app fun (app (app arrT ?n2) (app (app arrT ?n3) ?dt3))) (app (app arrT ?n3) (app (app arrT ?n2) ?dt3)))) (typeOf %0 (app (app arrT ?n2) (app (app arrT ?n3) ?dt3)))) (app (app arrT ?n3) (app (app arrT ?n2) ?dt3)))) (app (app arrT ?n2) ?dt2))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))) (app (app arrT ?n1) ?dt0)))"))))))))))))))) }),
        rw!("lift-reduce-seq-2"; "(typeOf (app (typeOf map ?) (typeOf (lam (typeOf (app (typeOf (app (typeOf add ?) (typeOf (app (typeOf fst ?) (typeOf %0 (app (app pairT f32) (app (app arrT ?n0) ?dt0)))) f32)) ?) (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq ?) (typeOf ?e0 (app (app fun f32) (app (app fun ?dt0) f32)))) ?) (typeOf 0.0 f32)) ?) (typeOf (app (typeOf snd ?) (typeOf %0 (app (app pairT f32) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n0) ?dt0))) f32)) ?)) (app (app fun (app (app pairT f32) (app (app arrT ?n1) ?dt1))) f32))) (app (app fun (app (app arrT ?n2) (app (app pairT f32) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n2) f32)))" => { shifted("?0", "?1", 4, 1, shifted("?n1", "?n4", 2, 0, shifted_check("?n1", "?n0", 1, 0, shifted("?n2", "?n5", 4, 0, shifted("?n2", "?n6", 3, 0, shifted("?n2", "?n3", 2, 0, shifted("?n2", "?n7", 1, 0, shifted("?dt1", "?dt4", 5, 0, shifted("?dt1", "?dt3", 4, 0, shifted("?dt1", "?dt5", 3, 0, shifted("?dt1", "?dt2", 2, 0, shifted_check("?dt1", "?dt0", 1, 0, pat("(typeOf (lam (typeOf (app (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun (app (app arrT ?n3) f32)) (app (app fun (app (app arrT ?n3) ?dt2)) (app (app arrT ?n3) f32)))) (app (app fun (app (app arrT ?n3) f32)) (app (app fun (app (app arrT ?n4) (app (app arrT ?n3) ?dt2))) (app (app arrT ?n3) f32))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app pairT f32) ?dt3)) f32)) (app (app fun (app (app arrT ?n5) (app (app pairT f32) ?dt3))) (app (app arrT ?n5) f32)))) (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e1 (app (app fun f32) (app (app fun ?dt4) f32))) (typeOf (app (typeOf fst (app (app fun (app (app pairT f32) ?dt4)) f32)) (typeOf %0 (app (app pairT f32) ?dt4))) f32)) (app (app fun ?dt4) f32)) (typeOf (app (typeOf snd (app (app fun (app (app pairT f32) ?dt4)) ?dt4)) (typeOf %0 (app (app pairT f32) ?dt4))) ?dt4)) f32)) (app (app fun (app (app pairT f32) ?dt3)) f32))) (app (app fun (app (app arrT ?n5) (app (app pairT f32) ?dt3))) (app (app arrT ?n5) f32))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n5) f32)) (app (app fun (app (app arrT ?n5) ?dt3)) (app (app arrT ?n5) (app (app pairT f32) ?dt3))))) (typeOf %1 (app (app arrT ?n5) f32))) (app (app fun (app (app arrT ?n5) ?dt3)) (app (app arrT ?n5) (app (app pairT f32) ?dt3)))) (typeOf %0 (app (app arrT ?n5) ?dt3))) (app (app arrT ?n5) (app (app pairT f32) ?dt3)))) (app (app arrT ?n5) f32))) (app (app fun (app (app arrT ?n6) ?dt5)) (app (app arrT ?n6) f32)))) (app (app fun (app (app arrT ?n3) f32)) (app (app fun (app (app arrT ?n3) ?dt2)) (app (app arrT ?n3) f32))))) (app (app fun (app (app arrT ?n3) f32)) (app (app fun (app (app arrT ?n4) (app (app arrT ?n3) ?dt2))) (app (app arrT ?n3) f32)))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT ?n3) f32)) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2)))) (app (app arrT ?n3) f32))) (typeOf %0 (app (app pairT (app (app arrT ?n3) f32)) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2))))) (app (app arrT ?n3) f32))) (app (app fun (app (app arrT ?n4) (app (app arrT ?n3) ?dt2))) (app (app arrT ?n3) f32))) (typeOf (app (typeOf transpose (app (app fun (app (app arrT ?n3) (app (app arrT ?n4) ?dt2))) (app (app arrT ?n4) (app (app arrT ?n3) ?dt2)))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT ?n3) f32)) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2)))) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2)))) (typeOf %0 (app (app pairT (app (app arrT ?n3) f32)) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2))))) (app (app arrT ?n3) (app (app arrT ?n4) ?dt2)))) (app (app arrT ?n4) (app (app arrT ?n3) ?dt2)))) (app (app arrT ?n3) f32))) (app (app fun (app (app pairT (app (app arrT ?n7) f32)) (app (app arrT ?n7) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n7) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT ?n7) (app (app pairT f32) (app (app arrT ?n0) ?dt0)))) (app (app pairT (app (app arrT ?n7) f32)) (app (app arrT ?n7) (app (app arrT ?n0) ?dt0))))) (typeOf %0 (app (app arrT ?n7) (app (app pairT f32) (app (app arrT ?n0) ?dt0))))) (app (app pairT (app (app arrT ?n7) f32)) (app (app arrT ?n7) (app (app arrT ?n0) ?dt0))))) (app (app arrT ?n7) f32))) (app (app fun (app (app arrT ?n2) (app (app pairT f32) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n2) f32)))"))))))))))))) }),
        rw!("lift-reduce-seq-3"; "(typeOf (app (typeOf map ?) (typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq ?) (typeOf ?e0 (app (app fun (app (app arrT ?n0) ?dt0)) (app (app fun (app (app arrT ?n0) ?dt1)) (app (app arrT ?n0) ?dt0))))) ?) (typeOf (app (typeOf fst ?) (typeOf (app (typeOf unzip ?) (typeOf %0 (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n0) ?dt0))) ?) (typeOf (app (typeOf transpose ?) (typeOf (app (typeOf snd ?) (typeOf (app (typeOf unzip ?) (typeOf %0 (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))) ?)) (app (app fun (app (app arrT ?n2) (app (app pairT ?dt2) (app (app arrT ?n3) ?dt3)))) (app (app arrT ?n2) ?dt2)))) (app (app fun (app (app arrT ?n4) (app (app arrT ?n2) (app (app pairT ?dt2) (app (app arrT ?n3) ?dt3))))) (app (app arrT ?n4) (app (app arrT ?n2) ?dt2))))" => { not_free_in("?0", 0, shifted("?0", "?1", 3, 1, shifted_check("?n3", "?n1", 1, 0, shifted("?n2", "?n8", 4, 0, shifted("?n2", "?n6", 3, 0, shifted("?n2", "?n10", 2, 0, shifted_check("?n2", "?n0", 1, 0, shifted("?n4", "?n7", 3, 0, shifted("?n4", "?n9", 2, 0, shifted("?n4", "?n5", 1, 0, shifted("?dt2", "?dt6", 4, 0, shifted("?dt2", "?dt4", 3, 0, shifted("?dt2", "?dt9", 2, 0, shifted_check("?dt2", "?dt0", 1, 0, shifted("?dt3", "?dt7", 4, 0, shifted("?dt3", "?dt5", 3, 0, shifted("?dt3", "?dt8", 2, 0, shifted_check("?dt3", "?dt1", 1, 0, pat("(typeOf (lam (typeOf (app (typeOf (app (typeOf (app (typeOf reduceSeq (app (app fun (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt1))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n5) (app (app arrT ?n0) ?dt1)))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))))) (typeOf (lam (typeOf (lam (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5))) (app (app arrT ?n6) ?dt4))) (app (app fun (app (app arrT ?n7) (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5)))) (app (app arrT ?n7) (app (app arrT ?n6) ?dt4))))) (typeOf (lam (typeOf (app (typeOf (app (typeOf ?e1 (app (app fun (app (app arrT ?n8) ?dt6)) (app (app fun (app (app arrT ?n8) ?dt7)) (app (app arrT ?n8) ?dt6)))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT ?n8) ?dt6)) (app (app arrT ?n8) ?dt7))) (app (app arrT ?n8) ?dt6))) (typeOf %0 (app (app pairT (app (app arrT ?n8) ?dt6)) (app (app arrT ?n8) ?dt7)))) (app (app arrT ?n8) ?dt6))) (app (app fun (app (app arrT ?n8) ?dt7)) (app (app arrT ?n8) ?dt6))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT ?n8) ?dt6)) (app (app arrT ?n8) ?dt7))) (app (app arrT ?n8) ?dt7))) (typeOf %0 (app (app pairT (app (app arrT ?n8) ?dt6)) (app (app arrT ?n8) ?dt7)))) (app (app arrT ?n8) ?dt7))) (app (app arrT ?n8) ?dt6))) (app (app fun (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5))) (app (app arrT ?n6) ?dt4)))) (app (app fun (app (app arrT ?n7) (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5)))) (app (app arrT ?n7) (app (app arrT ?n6) ?dt4)))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n7) (app (app arrT ?n6) ?dt4))) (app (app fun (app (app arrT ?n7) (app (app arrT ?n6) ?dt5))) (app (app arrT ?n7) (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5)))))) (typeOf %1 (app (app arrT ?n7) (app (app arrT ?n6) ?dt4)))) (app (app fun (app (app arrT ?n7) (app (app arrT ?n6) ?dt5))) (app (app arrT ?n7) (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5))))) (typeOf %0 (app (app arrT ?n7) (app (app arrT ?n6) ?dt5)))) (app (app arrT ?n7) (app (app pairT (app (app arrT ?n6) ?dt4)) (app (app arrT ?n6) ?dt5))))) (app (app arrT ?n7) (app (app arrT ?n6) ?dt4)))) (app (app fun (app (app arrT ?n9) (app (app arrT ?n10) ?dt8))) (app (app arrT ?n9) (app (app arrT ?n10) ?dt9))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt1))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n5) (app (app arrT ?n0) ?dt1)))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))))) (typeOf unzip (app (app fun (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (typeOf %0 (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n5) (app (app arrT ?n0) ?dt1)))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))) (typeOf (app (typeOf transpose (app (app fun (app (app arrT ?n5) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))) (app (app arrT ?n1) (app (app arrT ?n5) (app (app arrT ?n0) ?dt1))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n5) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))))) (typeOf transpose (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n5) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))))) (typeOf unzip (app (app fun (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app fun (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (typeOf %0 (app (app arrT ?n5) (app (app arrT ?n0) (app (app pairT ?dt0) (app (app arrT ?n1) ?dt1)))))) (app (app arrT ?n5) (app (app pairT (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app pairT (app (app arrT ?n5) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (app (app arrT ?n5) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n5) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (app (app arrT ?n1) (app (app arrT ?n5) (app (app arrT ?n0) ?dt1))))) (app (app arrT ?n5) (app (app arrT ?n0) ?dt0)))) (app (app fun (app (app arrT ?n4) (app (app arrT ?n2) (app (app pairT ?dt2) (app (app arrT ?n3) ?dt3))))) (app (app arrT ?n4) (app (app arrT ?n2) ?dt2))))"))))))))))))))))))) }),
        rw!("transpose-around-map-map-f-1m"; "(typeOf (app (typeOf (app (typeOf map ?) (typeOf (app (typeOf map ?) (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) ?) (typeOf ?e1 (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))" => "(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1)))))) (typeOf transpose (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1)))))) (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n1) ?dt0)) (app (app arrT ?n1) ?dt1))) (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT ?n1) ?dt0)) (app (app arrT ?n1) ?dt1)))) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT ?n1) ?dt0)) (app (app arrT ?n1) ?dt1)))) (app (app fun (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0)))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0)))))) (typeOf transpose (app (app fun (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))))) (app (app fun (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0)))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))))) (typeOf ?e1 (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt0))))) (app (app arrT ?n2) (app (app arrT ?n0) (app (app arrT ?n1) ?dt1))))) (app (app arrT ?n2) (app (app arrT ?n1) (app (app arrT ?n0) ?dt1))))"),
        rw!("store-to-mem"; "(typeOf ?e0 ?dt0)" => { shifted("?dt0", "?dt1", 1, 0, pat("(typeOf (app (typeOf (app (typeOf let (app (app fun ?dt0) (app (app fun (app (app fun ?dt0) ?dt0)) ?dt0))) (typeOf (app (typeOf toMem (app (app fun ?dt0) ?dt0)) (typeOf ?e0 ?dt0)) ?dt0)) (app (app fun (app (app fun ?dt0) ?dt0)) ?dt0)) (typeOf (lam (typeOf %0 ?dt1)) (app (app fun ?dt0) ?dt0))) ?dt0)")) }),
        rw!("map-array"; "(typeOf ?e0 (app (app arrT ?n0) ?dt0))" => { shifted("?dt0", "?dt1", 1, 0, pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt0) ?dt0)) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt0)))) (typeOf (lam (typeOf %0 ?dt1)) (app (app fun ?dt0) ?dt0))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt0))) (typeOf ?e0 (app (app arrT ?n0) ?dt0))) (app (app arrT ?n0) ?dt0))")) }),
        rw!("map-fusion"; "(typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e1 (app (app fun ?dt2) ?dt0))) ?) (typeOf ?e2 (app (app arrT ?n0) ?dt2))) (app (app arrT ?n0) ?dt0))) (app (app arrT ?n0) ?dt1))" => { shifted("?1", "?4", 1, 0, shifted("?0", "?3", 1, 0, shifted("?dt1", "?dt4", 1, 0, shifted("?dt2", "?dt5", 1, 0, shifted("?dt0", "?dt3", 1, 0, pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt2) ?dt1)) (app (app fun (app (app arrT ?n0) ?dt2)) (app (app arrT ?n0) ?dt1)))) (typeOf (lam (typeOf (app (typeOf ?e3 (app (app fun ?dt3) ?dt4)) (typeOf (app (typeOf ?e4 (app (app fun ?dt5) ?dt3)) (typeOf %0 ?dt5)) ?dt3)) ?dt4)) (app (app fun ?dt2) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt2)) (app (app arrT ?n0) ?dt1))) (typeOf ?e2 (app (app arrT ?n0) ?dt2))) (app (app arrT ?n0) ?dt1))")))))) }),
        rw!("map-eta-abstraction"; "(typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun ?dt0) ?dt1))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))" => { shifted("?0", "?1", 1, 0, shifted("?n0", "?n1", 1, 0, shifted("?dt0", "?dt2", 1, 0, shifted("?dt1", "?dt3", 1, 0, pat("(typeOf (lam (typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun ?dt2) ?dt3)) (app (app fun (app (app arrT ?n1) ?dt2)) (app (app arrT ?n1) ?dt3)))) (typeOf ?e1 (app (app fun ?dt2) ?dt3))) (app (app fun (app (app arrT ?n1) ?dt2)) (app (app arrT ?n1) ?dt3))) (typeOf %0 (app (app arrT ?n1) ?dt2))) (app (app arrT ?n1) ?dt3))) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1)))"))))) }),
        rw!("vec-32-after-f32"; "(typeOf ?e0 (app (app arrT ?n0) f32))" => { shifted("?n0", "?n1", 1, 0, pat("(typeOf (app (typeOf asScalar (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) f32))) (app (app arrT ?n0) f32))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 32) -1)) ?n1))) f32)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n1)) (app (app vecT %0) f32))))) 32) (app (app fun (app (app arrT ?n0) f32)) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) f32)))) (typeOf ?e0 (app (app arrT ?n0) f32))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) f32)))) (app (app arrT ?n0) f32))")) }),
        rw!("vec-32-after-(f32, f32)"; "(typeOf ?e0 (app (app arrT ?n0) (app (app pairT f32) f32)))" => { shifted("?n0", "?n1", 1, 0, pat("(typeOf (app (typeOf asScalar (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) f32)))) (app (app arrT ?n0) (app (app pairT f32) f32)))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 32) -1)) ?n1))) (app (app pairT f32) f32))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n1)) (app (app vecT %0) (app (app pairT f32) f32)))))) 32) (app (app fun (app (app arrT ?n0) (app (app pairT f32) f32))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) f32))))) (typeOf ?e0 (app (app arrT ?n0) (app (app pairT f32) f32)))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) f32))))) (app (app arrT ?n0) (app (app pairT f32) f32)))")) }),
        rw!("vec-32-after-(f32, (f32, f32))"; "(typeOf ?e0 (app (app arrT ?n0) (app (app pairT f32) (app (app pairT f32) f32))))" => { shifted("?n0", "?n1", 1, 0, pat("(typeOf (app (typeOf asScalar (app (app fun (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app arrT ?n0) (app (app pairT f32) (app (app pairT f32) f32))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) (app (app mul (app (app pow 32) -1)) ?n1))) (app (app pairT f32) (app (app pairT f32) f32)))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n1)) (app (app vecT %0) (app (app pairT f32) (app (app pairT f32) f32))))))) 32) (app (app fun (app (app arrT ?n0) (app (app pairT f32) (app (app pairT f32) f32)))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) (app (app pairT f32) f32)))))) (typeOf ?e0 (app (app arrT ?n0) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app arrT (app (app mul (app (app pow 32) -1)) ?n0)) (app (app vecT 32) (app (app pairT f32) (app (app pairT f32) f32)))))) (app (app arrT ?n0) (app (app pairT f32) (app (app pairT f32) f32))))")) }),
        rw!("vec-before-map-f32"; "(typeOf (app (typeOf (app (typeOf asVector ?) ?n0) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun f32) f32))) ?) (typeOf ?e1 (app (app arrT ?n1) f32))) (app (app arrT ?n2) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))" => { vectorize_scalar_fun("?0", "?n0", "?2", shifted("?n3", "?n4", 1, 0, compute_nat_check("?n1", "(app (app mul ?n3) ?n0)", compute_nat_check("?n2", "(app (app mul ?n3) ?n0)", pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32))))) (typeOf ?e2 (app (app fun (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))"))))) }),
        rw!("vec-before-map-f32xf32"; "(typeOf (app (typeOf (app (typeOf asVector ?) ?n0) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun (app (app pairT f32) f32)) f32))) ?) (typeOf ?e1 (app (app arrT ?n1) (app (app pairT f32) f32)))) (app (app arrT ?n2) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))" => { vectorize_scalar_fun("?0", "?n0", "?2", shifted("?n3", "?n4", 1, 0, compute_nat_check("?n1", "(app (app mul ?n3) ?n0)", compute_nat_check("?n2", "(app (app mul ?n3) ?n0)", pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app vecT ?n0) f32))))) (typeOf ?e2 (app (app fun (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))"))))) }),
        rw!("vec-before-map-f32x-f32xf32"; "(typeOf (app (typeOf (app (typeOf asVector ?) ?n0) ?) (typeOf (app (typeOf (app (typeOf map ?) (typeOf ?e0 (app (app fun (app (app pairT f32) (app (app pairT f32) f32))) f32))) ?) (typeOf ?e1 (app (app arrT ?n1) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app arrT ?n2) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))" => { vectorize_scalar_fun("?0", "?n0", "?2", shifted("?n3", "?n4", 1, 0, compute_nat_check("?n1", "(app (app mul ?n3) ?n0)", compute_nat_check("?n2", "(app (app mul ?n3) ?n0)", pat("(typeOf (app (typeOf (app (typeOf map (app (app fun (app (app fun (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (app (app arrT ?n3) (app (app vecT ?n0) f32))))) (typeOf ?e2 (app (app fun (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))))) (typeOf (app (typeOf (app (typeOf zip (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf fst (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app fun (app (app arrT ?n3) (app (app vecT ?n0) f32))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (typeOf (app (typeOf (app (typeOf asVector (lam (app (app fun (app (app arrT (app (app mul %0) ?n4)) f32)) (app (app arrT ?n4) (app (app vecT %0) f32))))) ?n0) (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (typeOf (app (typeOf snd (app (app fun (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (typeOf (app (typeOf unzip (app (app fun (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (typeOf ?e1 (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) (app (app pairT f32) f32))))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32))))) (app (app arrT (app (app mul ?n3) ?n0)) (app (app pairT f32) f32)))) (app (app pairT (app (app arrT (app (app mul ?n3) ?n0)) f32)) (app (app arrT (app (app mul ?n3) ?n0)) f32)))) (app (app arrT (app (app mul ?n3) ?n0)) f32))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32))))) (app (app arrT ?n3) (app (app pairT (app (app vecT ?n0) f32)) (app (app pairT (app (app vecT ?n0) f32)) (app (app vecT ?n0) f32)))))) (app (app arrT ?n3) (app (app vecT ?n0) f32)))"))))) }),
        rw!("reduce-seq-unroll"; "(typeOf reduceSeq (app (app fun (app (app fun ?dt0) (app (app fun ?dt1) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt1)) ?dt0))))" => "(typeOf reduceSeqUnroll (app (app fun (app (app fun ?dt0) (app (app fun ?dt1) ?dt0))) (app (app fun ?dt0) (app (app fun (app (app arrT ?n0) ?dt1)) ?dt0))))"),
        rw!("map-par"; "(typeOf map (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1))))" => "(typeOf mapPar (app (app fun (app (app fun ?dt0) ?dt1)) (app (app fun (app (app arrT ?n0) ?dt0)) (app (app arrT ?n0) ?dt1))))"),
    ]
}
